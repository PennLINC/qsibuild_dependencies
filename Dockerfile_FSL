FROM ubuntu:18.04
ARG TAG_ANTS

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
    ca-certificates \
    curl \
    bc \
    ca-certificates \
    curl \
    dc \
    sudo \
    python3 \
    wget

RUN wget https://fsl.fmrib.ox.ac.uk/fsldownloads/fslconda/releases/fslinstaller.py
RUN python3 fslinstaller.py --skip_registration --fslversion 6.0.7.9 --dest /usr/local/fsl/
RUN cd /usr/local/fsl \
      && rm -rf \
      doc \
      data/possum \
      src \
      bin/fslview* \
      bin/FSLeyes \
      data/standard/bianca \
      doc \
      etc/default_flobs.flobs \
      refdoc \
      tcl \
      extras \
      python \
      data/xtract_data

RUN cd /usr/local/fsl/bin \
    && rm \
        AnatomicalAverage \
        ApplyXFM \
        Bet \
        ConcatXFM \
        Fast \
        Fdt \
        Feat \
        Featquery \
        Flirt \
        Fsl_prepare_fieldmap \
        Glm \
        InvertXFM \
        Make_flobs \
        Melodic \
        Nudge \
        Pnm \
        Possum \
        Renderhighres \
        Renderstats \
        Runtcl \
        Susan \
        Text2Vest \
        Vest2Text \
        asl_calib \
        asl_file \
        asl_gui \
        asl_mfree \
        asl_reg \
        atlasquery \
        autoaq \
        avw2fsl \
        b0calc \
        basil \
        basil_var \
        baycest \
        bianca \
        bianca_cluster_stats \
        bianca_overlap_measures \
        bianca_perivent_deep \
        calc_grad_perc_dev \
        ccops \
        checkFEAT \
        cluster \
        cluster2html \
        connectedcomp \
        contrast_mgr \
        cutoffcalc \
        design_ttest2 \
        distancemap \
        drawmesh \
        dual_regression \
        easythresh \
        estnoise \
        fabber \
        fabber_asl \
        fabber_cest \
        fabber_dce \
        fabber_dsc \
        fabber_dualecho \
        fabber_dwi \
        fabber_pet \
        fabber_qbold \
        fabber_t1 \
        fabber_var \
        fdr \
        feat \
        feat_gm_prepare \
        feat_model \
        featquery \
        featregapply \
        film_cifti \
        film_gls \
        filmbabe \
        filmbabescript \
        flameo \
        first3Dview \
        fsl2ascii \
        fsl_anat \
        fsl_boxplot \
        fsl_deface \
        fsl_gen_3D \
        fsl_glm \
        fsl_histogram \
        fsl_motion_outliers \
        fsl_mvlm \
        fsl_mrs* \
        fsl_reg \
        fsl_regfilt \
        fsl_sbca \
        fsl_schurprod \
        fsladd \
        fslanimate \
        fslascii2img \
        fslcc \
        fslcomplex \
        fslcreatehd \
        fslerrorreport \
        fslinterleave \
        fslsmoothfill \
        fslsurfacemaths \
        fsltclsh \
        fslval \
        fslvbm_1_bet \
        fslvbm_2_template \
        fslvbm_3_proc \
        fslwish \
        ftoz \
        generateConfounds \
        generate_b0 \
        generate_b0calc \
        generate_brain \
        hist2prob \
        label2surf \
        lesion_filling \
        mainfeatreg \
        make_bianca_mask \
        match_smoothing \
        mccutup \
        melodic \
        merge_parts_gpu \
        midtrans \
        mist \
        mist_1_train \
        mist_2_fit \
        mist_FA_reg \
        mist_display \
        mist_mesh_utils \
        mm \
        morph_kernel \
        mp_diffpow.sh \
        msm \
        msm_metric_sim \
        msmapplywarp \
        msmresample \
        mvntool \
        old_betall \
        overlay \
        oxford_asl \
        perfusion_subtract \
        pnm_evs \
        pnm_stage1 \
        pointflirt \
        popp \
        possum \
        possumX \
        possumX_postproc.sh \
        possum_interpmot.py \
        possum_matrix \
        possum_plot.py \
        possum_sum \
        prewhiten \
        proj_thresh \
        ptoz \
        pulse \
        quasil \
        randomise \
        randomise_parallel \
        renderhighres \
        rmsdiff \
        run_mesh_utils \
        selfintersection \
        setFEAT \
        siena \
        siena_cal \
        siena_diff \
        siena_flirt \
        siena_flow2std \
        sienax \
        sigloss \
        signal2image \
        sliceanimate \
        slicer \
        slices \
        slices_summary \
        slicesdir \
        slicesmask \
        slicetimer \
        smoothest \
        split_parts_gpu \
        std2imgcoord \
        surf2surf \
        surf2volume \
        surf_proj \
        surface_fdr \
        surfmaths \
        susan \
        swap_subjectwise \
        swap_voxelwise \
        swe \
        systemnoise \
        tmpnam \
        toast \
        tsplot \
        ttologp \
        ttoz \
        unconfound \
        updatefeatreg \
        verbena \
        viena_createpng \
        viena_quant \
        whirlgif \
        xtract \
        xtract_blueprint \
        xtract_stats \
        xtract_viewer \
        ztop

RUN cd /usr/local/fsl/lib \
    && rm \
        *VTK* \
        *fabber* \
        libvtk*

RUN cd /usr/local/fsl/data \
    && rm \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr0-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr0-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr25-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr25-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr50-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-maxprob-thr50-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-prob-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIflirt-prob-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr0-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr0-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr25-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr25-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr50-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-maxprob-thr50-2mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-prob-1mm.nii.gz \
        atlases/Cerebellum/Cerebellum-MNIfnirt-prob-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr0-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr0-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr25-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr25-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr50-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-maxprob-thr50-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-prob-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-cort-prob-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr0-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr0-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr25-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr25-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr50-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-maxprob-thr50-2mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-prob-1mm.nii.gz \
        atlases/HarvardOxford/HarvardOxford-sub-prob-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-DWI-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-DWI-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-FA-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-FA-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-T2-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-T2-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-labels-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-labels-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr0-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr0-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr25-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr25-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr50-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-maxprob-thr50-2mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-prob-1mm.nii.gz \
        atlases/JHU/JHU-ICBM-tracts-prob-2mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr0-1mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr0-2mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr25-1mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr25-2mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr50-1mm.nii.gz \
        atlases/Juelich/Juelich-maxprob-thr50-2mm.nii.gz \
        atlases/Juelich/Juelich-prob-1mm.nii.gz \
        atlases/Juelich/Juelich-prob-2mm.nii.gz \
        atlases/MarsParietalParcellation/Parietal_thr25_1mm.nii.gz \
        atlases/MarsParietalParcellation/Parietal_thr25_2mm.nii.gz \
        atlases/MarsParietalParcellation/Parietal_thr75_summaryimage_1mm.nii.gz \
        atlases/MarsParietalParcellation/Parietal_thr75_summaryimage_2mm.nii.gz \
        atlases/MarsTPJParcellation/TPJ_thr25_1mm.nii.gz \
        atlases/MarsTPJParcellation/TPJ_thr25_2mm.nii.gz \
        atlases/MarsTPJParcellation/TPJ_thr50_summaryimage_1mm.nii.gz \
        atlases/MarsTPJParcellation/TPJ_thr50_summaryimage_2mm.nii.gz \
        atlases/NeubertVentralFrontalParcellation/VentralFrontal_thr25_1mm.nii.gz \
        atlases/NeubertVentralFrontalParcellation/VentralFrontal_thr25_2mm.nii.gz \
        atlases/NeubertVentralFrontalParcellation/VentralFrontal_thr75_summaryimage_1mm.nii.gz \
        atlases/NeubertVentralFrontalParcellation/VentralFrontal_thr75_summaryimage_2mm.nii.gz \
        atlases/SMATT/SMATT-labels-1mm.nii.gz \
        atlases/STN/STN-maxprob-thr0-0.5mm.nii.gz \
        atlases/STN/STN-maxprob-thr25-0.5mm.nii.gz \
        atlases/STN/STN-maxprob-thr50-0.5mm.nii.gz \
        atlases/STN/STN-prob-0.5mm.nii.gz \
        atlases/SalletDorsalFrontalParcellation/DorsalFrontal_thr25_1mm.nii.gz \
        atlases/SalletDorsalFrontalParcellation/DorsalFrontal_thr25_2mm.nii.gz \
        atlases/SalletDorsalFrontalParcellation/DorsalFrontal_thr50_summaryimage_1mm.nii.gz \
        atlases/SalletDorsalFrontalParcellation/DorsalFrontal_thr50_summaryimage_2mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr25-3sub-1mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr25-3sub-2mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr25-7sub-1mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr25-7sub-2mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr50-3sub-1mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr50-3sub-2mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr50-7sub-1mm.nii.gz \
        atlases/Striatum/striatum-con-label-thr50-7sub-2mm.nii.gz \
        atlases/Striatum/striatum-con-prob-thr25-1mm.nii.gz \
        atlases/Striatum/striatum-con-prob-thr25-2mm.nii.gz \
        atlases/Striatum/striatum-con-prob-thr50-1mm.nii.gz \
        atlases/Striatum/striatum-con-prob-thr50-2mm.nii.gz \
        atlases/Striatum/striatum-structural-1mm.nii.gz \
        atlases/Striatum/striatum-structural-2mm.nii.gz \
        atlases/Talairach/Talairach-labels-1mm.nii.gz \
        atlases/Talairach/Talairach-labels-2mm.nii.gz \
        atlases/XTRACT/xtract-mac-tract-atlases-maxprob5-1mm.nii.gz \
        atlases/XTRACT/xtract-mac-tract-atlases-prob-1mm.nii.gz \
        atlases/XTRACT/xtract-tract-atlases-maxprob5-1mm.nii.gz \
        atlases/XTRACT/xtract-tract-atlases-prob-1mm.nii.gz \
        linearMNI/MNI152lin_T1_1mm.nii.gz \
        linearMNI/MNI152lin_T1_1mm_brain.nii.gz \
        linearMNI/MNI152lin_T1_2mm.nii.gz \
        linearMNI/MNI152lin_T1_2mm_brain.nii.gz \
        linearMNI/MNI152lin_T1_2mm_brain_mask.nii.gz \
        mist/masks/amygdala_thr75.nii.gz \
        mist/masks/caudate_accumbens_thr75.nii.gz \
        mist/masks/csf_thr75.nii.gz \
        mist/masks/globus_pallidus_external_eroded.nii.gz \
        mist/masks/globus_pallidus_internal_eroded.nii.gz \
        mist/masks/hippocampus_thr75.nii.gz \
        mist/masks/pallidum_thr75.nii.gz \
        mist/masks/putamen_thr75.nii.gz \
        mist/masks/red_nuclei_eroded.nii.gz \
        mist/masks/substantia_nigra_eroded.nii.gz \
        mist/masks/subthalamic_nuclei_eroded.nii.gz \
        mist/masks/thalamus_thr75.nii.gz \
        mist/masks/wm_thr75.nii.gz \
        mist/meshes/left_amygdala.gii \
        mist/meshes/left_amygdala.mim \
        mist/meshes/left_caudate_accumbens.gii \
        mist/meshes/left_caudate_accumbens.mim \
        mist/meshes/left_globus_pallidus_external.gii \
        mist/meshes/left_globus_pallidus_external.mim \
        mist/meshes/left_globus_pallidus_internal.gii \
        mist/meshes/left_globus_pallidus_internal.mim \
        mist/meshes/left_hippocampus.gii \
        mist/meshes/left_hippocampus.mim \
        mist/meshes/left_pallidum.gii \
        mist/meshes/left_pallidum.mim \
        mist/meshes/left_putamen.gii \
        mist/meshes/left_putamen.mim \
        mist/meshes/left_red_nucleus.gii \
        mist/meshes/left_red_nucleus.mim \
        mist/meshes/left_substantia_nigra.gii \
        mist/meshes/left_substantia_nigra.mim \
        mist/meshes/left_subthalamic_nucleus.gii \
        mist/meshes/left_subthalamic_nucleus.mim \
        mist/meshes/left_thalamus.gii \
        mist/meshes/left_thalamus.mim \
        mist/meshes/make_all_meshes.sh \
        mist/meshes/right_amygdala.gii \
        mist/meshes/right_amygdala.mim \
        mist/meshes/right_caudate_accumbens.gii \
        mist/meshes/right_caudate_accumbens.mim \
        mist/meshes/right_globus_pallidus_external.gii \
        mist/meshes/right_globus_pallidus_external.mim \
        mist/meshes/right_globus_pallidus_internal.gii \
        mist/meshes/right_globus_pallidus_internal.mim \
        mist/meshes/right_hippocampus.gii \
        mist/meshes/right_hippocampus.mim \
        mist/meshes/right_pallidum.gii \
        mist/meshes/right_pallidum.mim \
        mist/meshes/right_putamen.gii \
        mist/meshes/right_putamen.mim \
        mist/meshes/right_red_nucleus.gii \
        mist/meshes/right_red_nucleus.mim \
        mist/meshes/right_substantia_nigra.gii \
        mist/meshes/right_substantia_nigra.mim \
        mist/meshes/right_subthalamic_nucleus.gii \
        mist/meshes/right_subthalamic_nucleus.mim \
        mist/meshes/right_thalamus.gii \
        mist/meshes/right_thalamus.mim \
        standard/FSL_HCP1065_L1_1mm.nii.gz \
        standard/FSL_HCP1065_L2_1mm.nii.gz \
        standard/FSL_HCP1065_L3_1mm.nii.gz \
        standard/FSL_HCP1065_MD_1mm.nii.gz \
        standard/FSL_HCP1065_MO_1mm.nii.gz \
        standard/FSL_HCP1065_V1_1mm.nii.gz \
        standard/FSL_HCP1065_V2_1mm.nii.gz \
        standard/FSL_HCP1065_V3_1mm.nii.gz \
        standard/Fornix_FMRIB_FA1mm.nii.gz \
        standard/LowerCingulum_1mm.nii.gz \
        standard/MNI152_T1_0.5mm.nii.gz \
        standard/MNI152_T1_1mm_BigFoV_facemask.nii.gz \
        standard/MNI152_T1_1mm_Hipp_mask_dil8.nii.gz \
        standard/MNI152_T1_1mm_brain_mask_dil.nii.gz \
        standard/MNI152_T1_2mm.nii.gz \
        standard/MNI152_T1_2mm_LR-masked.nii.gz \
        standard/MNI152_T1_2mm_VentricleMask.nii.gz \
        standard/MNI152_T1_2mm_b0.nii.gz \
        standard/MNI152_T1_2mm_brain.nii.gz \
        standard/MNI152_T1_2mm_brain_mask.nii.gz \
        standard/MNI152_T1_2mm_brain_mask_deweight_eyes.nii.gz \
        standard/MNI152_T1_2mm_brain_mask_dil.nii.gz \
        standard/MNI152_T1_2mm_brain_mask_dil1.nii.gz \
        standard/MNI152_T1_2mm_edges.nii.gz \
        standard/MNI152_T1_2mm_eye_mask.nii.gz \
        standard/MNI152_T1_2mm_skull.nii.gz \
        standard/MNI152_T1_2mm_strucseg.nii.gz \
        standard/MNI152_T1_2mm_strucseg_periph.nii.gz
